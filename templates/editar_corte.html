{% extends "base.html" %}
{% block title %}Editar Corte{% endblock %}
{% block header %}âœï¸ Editar Corte{% endblock %}

{% block content %}
<div class="container my-3">
    <form action="{{ url_for('editar_corte', corte_id=corte.id) }}" method="POST" class="needs-validation">

        <!-- Fecha -->
        <div class="card shadow-sm mb-3 p-3 border-0 rounded-4">
            <label for="fecha" class="form-label fs-6 fw-bold">ğŸ“… Fecha</label>
            <input type="date" class="form-control form-control-lg" id="fecha" name="fecha" value="{{ corte.fecha }}" required>
        </div>

        <!-- NÃºmero de Corte -->
        <div class="card shadow-sm mb-3 p-3 border-0 rounded-4">
            <label for="corte" class="form-label fs-6 fw-bold">ğŸ”¢ NÃºmero de Corte</label>
            <input type="number" class="form-control form-control-lg" id="corte" name="corte" value="{{ corte.numero_corte }}" required>
        </div>

        <!-- Color -->
        <div class="card shadow-sm mb-3 p-3 border-0 rounded-4">
            <label for="color" class="form-label fs-6 fw-bold">ğŸ¨ Color</label>
            <select class="form-select form-select-lg" id="color" name="color" required>
                <option value="">-- Selecciona un color --</option>
                {% for c in colores %}
                    <option value="{{ c.id }}" {% if c.id == corte.color_id %}selected{% endif %}>
                        {{ c.nombre }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- Metros -->
        <div class="card shadow-sm mb-3 p-3 border-0 rounded-4">
            <label for="metros" class="form-label fs-6 fw-bold">ğŸ“ Metros de Tela</label>
            <input type="number" class="form-control form-control-lg" id="metros" name="metros" value="{{ corte.metros }}" required>
        </div>

        <!-- Tallas -->
        <div class="card shadow-sm mb-3 p-3 border-0 rounded-4">
            <label class="form-label fs-6 fw-bold">ğŸ‘• Tallas</label>
            <div class="d-flex flex-wrap gap-3">
                {% for t in tallas %}
                    {% set prod = produccion_dict.get(t.id|string) %}
                    <div class="form-check form-check-inline">
                        <input class="btn-check" type="checkbox" id="talla{{ t.id }}" name="tallas" value="{{ t.id }}"
                               {% if prod %} checked {% endif %}
                               {% if prod and prod.status_id != 1 %} disabled {% endif %}>
                        <label class="btn btn-outline-primary rounded-pill px-3 {% if prod and prod.status_id != 1 %}disabled{% endif %}" for="talla{{ t.id }}">
                            {{ t.nombre }}
                            {% if prod and prod.status_id != 1 %}
                                <small class="text-muted">({{ prod.status.nombre }})</small>
                            {% endif %}
                        </label>
                    </div>
                {% endfor %}
            </div>
        </div>

        <!-- Cantidad -->
        <div class="card shadow-sm mb-3 p-3 border-0 rounded-4">
            <label for="cantidad" class="form-label fs-6 fw-bold">ğŸ“¦ Cantidad por Talla</label>
            <input type="number" class="form-control form-control-lg" id="cantidad" name="cantidad" 
                   value="{{ produccion[0].cantidad if produccion else '' }}" required>
        </div>

        <!-- Botones -->
        <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary btn-lg rounded-pill shadow-sm">
                <i class="bi bi-save"></i> Guardar Cambios
            </button>
            <a href="{{ url_for('ver_cortes') }}" class="btn btn-outline-secondary btn-lg rounded-pill shadow-sm">
                <i class="bi bi-x-circle"></i> Cancelar
            </a>
        </div>
    </form>
</div>
{% endblock %}
